<h1>üìã Xem ch·∫•m c√¥ng</h1>

<label>Ch·ªçn th√°ng: <input type="month" id="monthPicker"></label>
<button id="searchBtn">T√¨m</button>

<table>
  <thead>
    <tr>
      <th>Ng√†y</th>
      <th>Nh√¢n vi√™n</th>
      <th>Ca s√°ng (V√†o-Ra)</th>
      <th>Ca chi·ªÅu (V√†o-Ra)</th>
      <th>ƒêi mu·ªôn / V·ªÅ s·ªõm</th>
      <th>Gi·ªù l√†m</th>
      <th>ƒê·ªãa ƒëi·ªÉm qu√©t</th>
      <th>N·ªôi dung QR</th>
    </tr>
  </thead>
  <tbody id="attendanceTable"></tbody>
</table>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyAb5AZOBvEVY3a_9ioEKTW-wuVMXdnRZGQ",
  authDomain: "sellglass-3ebe9.firebaseapp.com",
  databaseURL: "https://sellglass-3ebe9-default-rtdb.asia-southeast1.firebasedatabase.app", // <- s·ª≠a l·∫°i
  projectId: "sellglass-3ebe9",
  storageBucket: "sellglass-3ebe9.appspot.com",
  messagingSenderId: "513741829035",
  appId: "1:513741829035:web:1b2c59dcf1a0be329358ee"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

document.getElementById('searchBtn').addEventListener('click', () => {
  const monthVal = document.getElementById('monthPicker').value; // YYYY-MM
  if(!monthVal) return alert('Ch·ªçn th√°ng!');
  loadAttendance(monthVal);
});

function loadAttendance(monthVal){
  const tbody = document.getElementById('attendanceTable');
  tbody.innerHTML = '';
  db.ref('chamcong').once('value').then(snapshot=>{
    snapshot.forEach(empSnap=>{
      const empId = empSnap.key;
      const days = empSnap.val();
      Object.keys(days).forEach(day=>{
        if(day.startsWith(monthVal)){
          const data = days[day];
          const row = `<tr>
            <td>${day}</td>
            <td>${empId}</td>
            <td>${data.vaoCaSang||'-'} - ${data.raCaSang||'-'}</td>
            <td>${data.vaoCaChieu||'-'} - ${data.raCaChieu||'-'}</td>
            <td>${data.diMuon || ''}</td>
            <td>${data.gioLamTrongNgay || ''}</td>
            <td>${data.diadiemQuet || ''}</td>
            <td>${data.noiDungMaQuet || ''}</td>
          </tr>`;
          tbody.innerHTML += row;
        }
      });
    });
  });
}
</script>

